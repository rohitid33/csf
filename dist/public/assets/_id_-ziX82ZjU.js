import{r,af as z,j as e,$ as U,ac as ee,M,N as q,O as H,Q as R,T as O,V as C,B as N,a as V,ag as Te,ah as Ne,ai as be,aj as Ce,ak as ye,al as F,v as K,w as G,W as De,b as Q,Y as Se,R as Ee}from"./index-B3yLkj_P.js";import{B as v}from"./badge-4B3PkiTv.js";import{T as Ae,a as Ie,b as W,c as Y}from"./tabs-C-rN83Db.js";import{D as te,a as se,b as ae,c as ie,d as re,f as Pe}from"./dialog-D6CLHQOt.js";import{A as ne,a as le,b as oe,c as ce,d as de,e as he,f as me,g as ue,h as xe}from"./alert-dialog-D7AW1HCX.js";import{T as Le,a as $e,b as Be,c as X,d as $,e as Fe,f as B}from"./table-DbxJySh8.js";function Ue(){const[i,a]=r.useState({});return r.useEffect(()=>{const g=window.location.pathname;console.log("Current pathname:",g);const p=g.split("/");console.log("URL segments:",p);const m=p[p.length-1];console.log("Extracted ID:",m),m&&m!==""?a({id:m}):console.error("Could not extract ID from URL:",g)},[]),i}function Me(){return i=>{console.log("Navigating to:",i),window.location.href=i}}const ge=({ticketId:i,task:a,onSuccess:g})=>{const[p,m]=r.useState(!1),[n,k]=r.useState(null),[h,P]=r.useState(null),{isAdminAuthenticated:S}=z(),[c,y]=r.useState({title:(a==null?void 0:a.title)||"",description:(a==null?void 0:a.description)||"",status:(a==null?void 0:a.status)||"pending",dueDate:a!=null&&a.dueDate?new Date(a.dueDate).toISOString().split("T")[0]:""});r.useEffect(()=>{i&&!a&&S&&(async()=>{try{if(!S){console.error("Admin authentication required");return}const d=localStorage.getItem("adminToken");if(!d){console.error("Admin token not found");return}const f=await fetch(`/api/admin/tickets/${i}`,{headers:{Accept:"application/json",Authorization:`Bearer ${d}`}});if(f.ok){const w=await f.json();w&&w.ticket&&(P(w.ticket),console.log("Ticket details fetched:",w.ticket))}else console.error("Failed to fetch ticket details:",f.statusText)}catch(d){console.error("Error fetching ticket details:",d)}})()},[i,a,S]);const b=u=>{const{name:d,value:f}=u.target;y(w=>({...w,[d]:f}))},A=(u,d)=>{y(f=>({...f,[u]:d}))},E=async u=>{if(u.preventDefault(),!c.title.trim()){k("Title is required");return}if(!c.dueDate){k("Due date is required");return}if(!S){k("Admin authentication required");return}m(!0),k(null);try{const d=localStorage.getItem("adminToken");if(!d)throw new Error("Admin authentication required. Please log in again.");const f=a?`/api/admin/tasks/${a.id}`:`/api/admin/tickets/${i}/tasks`,w=a?"PUT":"POST";let I;if(a)I={title:c.title,description:c.description||a.description||"",status:c.status||a.status,assigneeId:a.assigneeId,dueDate:new Date(c.dueDate).toISOString()};else{if(!h||!h.userId){k("Could not determine the ticket creator. Please try again later."),m(!1);return}I={title:c.title,description:c.description||"",status:c.status||"pending",ticketId:i,assigneeId:h.userId,dueDate:new Date(c.dueDate).toISOString()}}console.log("Sending task data:",{url:f,method:w,data:I});const t=await fetch(f,{method:w,headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(I)});if(!t.ok){if(t.status===401)throw localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.");let o=`Failed to save task: ${t.status} ${t.statusText}`;try{const l=await t.json();console.error("Task save error (JSON):",l),l.message?o=`Server error: ${l.message}`:l.error&&(o=`Server error: ${l.error}`)}catch{try{const j=await t.text();console.error("Task save error (Text):",j),j&&(o=`Server error: ${j}`)}catch{console.error("Could not parse error response")}}throw new Error(o)}g()}catch(d){console.error("Error saving task:",d),k(d instanceof Error?d.message:"An error occurred")}finally{m(!1)}};return e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[n&&e.jsx("div",{className:"bg-red-100 text-red-800 p-3 rounded-md text-sm",children:n}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),e.jsx(U,{name:"title",value:c.title,onChange:b,placeholder:"Enter task title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx(ee,{name:"description",value:c.description,onChange:b,placeholder:"Enter task description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs(M,{value:c.status,onValueChange:u=>A("status",u),children:[e.jsx(q,{children:e.jsx(H,{placeholder:"Select status"})}),e.jsx(R,{children:e.jsxs(O,{children:[e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"in_progress",children:"In Progress"}),e.jsx(C,{value:"completed",children:"Completed"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Due Date *"}),e.jsx(U,{type:"date",name:"dueDate",value:c.dueDate,onChange:b,required:!0,min:new Date().toISOString().split("T")[0]})]})]}),e.jsx("div",{className:"flex justify-end space-x-2 pt-4",children:e.jsx(N,{type:"submit",disabled:p,children:p?"Saving...":a?"Update Task":"Create Task"})})]})},qe=i=>e.jsx("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i,children:e.jsx("path",{d:"M11.8536 1.14645C11.6583 0.951184 11.3417 0.951184 11.1465 1.14645L3.71455 8.57836C3.62459 8.66832 3.55263 8.77461 3.50251 8.89155L2.04044 12.303C1.9599 12.491 2.00189 12.709 2.14646 12.8536C2.29103 12.9981 2.50905 13.0401 2.69697 12.9596L6.10847 11.4975C6.2254 11.4474 6.3317 11.3754 6.42166 11.2855L13.8536 3.85355C14.0488 3.65829 14.0488 3.34171 13.8536 3.14645L11.8536 1.14645ZM4.42166 9.28547L11.5 2.20711L12.7929 3.5L5.71455 10.5784L4.21924 11.2192L3.78081 10.7808L4.42166 9.28547Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}),He=i=>e.jsx("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i,children:e.jsx("path",{d:"M5.5 1C5.22386 1 5 1.22386 5 1.5C5 1.77614 5.22386 2 5.5 2H9.5C9.77614 2 10 1.77614 10 1.5C10 1.22386 9.77614 1 9.5 1H5.5ZM3 3.5C3 3.22386 3.22386 3 3.5 3H11.5C11.7761 3 12 3.22386 12 3.5C12 3.77614 11.7761 4 11.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3.5 5C3.22386 5 3 5.22386 3 5.5V12.5C3 12.7761 3.22386 13 3.5 13H11.5C11.7761 13 12 12.7761 12 12.5V5.5C12 5.22386 11.7761 5 11.5 5H3.5ZM4 12V6H11V12H4Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}),Re=({ticketId:i,id:a})=>{const[g,p]=r.useState([]),[m,n]=r.useState(!0),[k,h]=r.useState(null),[P,S]=r.useState(null),[c,y]=r.useState(!1),{isAdminAuthenticated:b}=z();r.useEffect(()=>{i||(h("No ticket ID provided"),n(!1))},[i]);const A=r.useCallback(async()=>{if(!i){h("No ticket ID provided"),n(!1);return}if(!b){h("Admin authentication required to view tasks"),n(!1);return}n(!0);try{const t=localStorage.getItem("adminToken");if(!t)throw new Error("Admin authentication required. Please log in again.");const o=await fetch(`/api/admin/tickets/${i}/tasks`,{headers:{Accept:"application/json",Authorization:`Bearer ${t}`}});if(!o.ok)throw o.status===401?(localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.")):new Error("Failed to fetch tasks");const l=await o.json();p(l)}catch(t){console.error("Error fetching tasks:",t),h(t instanceof Error?t.message:"An error occurred")}finally{n(!1)}},[i,b]);r.useEffect(()=>{i&&b&&A()},[i,A,b]);const E=async t=>{if(!i){h("No ticket ID provided");return}try{const o=localStorage.getItem("adminToken");if(!o)throw new Error("Admin authentication required. Please log in again.");const l=await fetch(`/api/admin/tasks/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}});if(!l.ok)throw l.status===401?(localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.")):new Error("Failed to delete task");p(g.filter(j=>j.id!==t))}catch(o){console.error("Error deleting task:",o),h(o instanceof Error?o.message:"Failed to delete task")}},u=async(t,o)=>{if(!i){h("No ticket ID provided");return}try{const l=localStorage.getItem("adminToken");if(!l)throw new Error("Admin authentication required. Please log in again.");const j=await fetch(`/api/admin/tasks/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({status:o})});if(!j.ok)throw j.status===401?(localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.")):new Error("Failed to update task status");await j.json(),p(g.map(L=>L.id===t?{...L,status:o}:L))}catch(l){console.error("Error updating task status:",l),h(l instanceof Error?l.message:"Failed to update task status")}},d=t=>{S(t),y(!0)},f=()=>{y(!1),S(null),A()},w=t=>{switch(t){case"pending":return e.jsx(v,{className:"bg-gray-100 text-gray-800",children:"Pending"});case"in_progress":return e.jsx(v,{className:"bg-blue-100 text-blue-800",children:"In Progress"});case"completed":return e.jsx(v,{className:"bg-green-100 text-green-800",children:"Completed"});default:return e.jsx(v,{children:t})}};if(m)return e.jsx("div",{className:"text-center py-6",children:"Loading tasks..."});if(k)return e.jsxs("div",{className:"bg-red-100 text-red-800 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:"Error"}),e.jsx("p",{children:k}),k==="No ticket ID provided"&&e.jsx("p",{className:"mt-2",children:"Please select a valid ticket to view its tasks."})]});const I=t=>{const o=document.getElementById(`delete-dialog-${t}`);o&&o.click()};return e.jsxs("div",{id:a,children:[g.length===0?e.jsxs(V,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-gray-500",children:"No tasks have been created for this ticket yet."}),e.jsx("p",{className:"text-gray-500 mt-2",children:'Use the "Add New Task" button to create a task.'})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(Le,{children:[e.jsx($e,{children:"List of tasks for this ticket"}),e.jsx(Be,{children:e.jsxs(X,{children:[e.jsx($,{children:"Title"}),e.jsx($,{children:"Description"}),e.jsx($,{children:"Status"}),e.jsx($,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(Fe,{children:g.map(t=>e.jsxs(X,{children:[e.jsx(B,{className:"font-medium",children:t.title}),e.jsx(B,{className:"max-w-[300px] truncate",children:t.description}),e.jsx(B,{children:e.jsxs(Te,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx(N,{variant:"ghost",className:"h-8 p-0",children:w(t.status)})}),e.jsxs(be,{align:"end",children:[e.jsx(Ce,{children:"Change Status"}),e.jsx(ye,{}),e.jsx(F,{onClick:()=>u(t.id,"pending"),children:"Pending"}),e.jsx(F,{onClick:()=>u(t.id,"in_progress"),children:"In Progress"}),e.jsx(F,{onClick:()=>u(t.id,"completed"),children:"Completed"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>d(t),children:[e.jsx("span",{className:"sr-only",children:"Edit"}),e.jsx(qe,{className:"h-4 w-4"})]}),e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>I(t.id),children:[e.jsx("span",{className:"sr-only",children:"Delete"}),e.jsx(He,{className:"h-4 w-4"})]}),e.jsxs(ne,{children:[e.jsx(le,{asChild:!0,children:e.jsx("button",{id:`delete-dialog-${t.id}`,className:"hidden",children:"Delete"})}),e.jsxs(oe,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Are you sure?"}),e.jsx(he,{children:"This action cannot be undone. This will permanently delete the task."})]}),e.jsxs(me,{children:[e.jsx(ue,{children:"Cancel"}),e.jsx(xe,{onClick:()=>E(t.id),children:"Delete"})]})]})]})]})})]},t.id))})]})}),P&&e.jsx(te,{open:c,onOpenChange:y,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Edit Task"}),e.jsx(re,{children:"Update the task details below."})]}),e.jsx(ge,{ticketId:i,task:P,onSuccess:f})]})})]})},Oe=({ticketIdProp:i})=>{const{id:a}=Ue(),g=Me(),{isAdminAuthenticated:p}=z(),m=i||a;console.log("Ticket ID being used:",m);const[n,k]=r.useState(null),[h,P]=r.useState(null),[S,c]=r.useState(!0),[y,b]=r.useState(!1),[A,E]=r.useState(null),[u,d]=r.useState(!1),[f,w]=r.useState(!1),[I,t]=r.useState(0),o=()=>{t(s=>s+1)},[l,j]=r.useState({title:"",description:"",status:"",priority:""}),L=async()=>{if(!m){console.error("No ticket ID provided"),E("No ticket ID provided"),c(!1);return}if(!p){console.error("Not authenticated as admin"),E("Admin authentication required to view ticket details"),c(!1);return}console.log("Fetching ticket details for ID:",m),c(!0);try{const s=localStorage.getItem("adminToken");if(!s)throw new Error("Admin authentication required. Please log in again.");const x=`/api/admin/tickets/${m}`;console.log("Fetching from URL:",x);const T=await fetch(x,{headers:{Accept:"application/json",Authorization:`Bearer ${s}`}});if(console.log("Response status:",T.status),!T.ok){const ke=await T.text();throw console.error("Error response:",ke),T.status===401?(localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.")):new Error(`Failed to fetch ticket details: ${T.status} ${T.statusText}`)}const D=await T.json();if(console.log("Ticket data received:",D),!D.ticket)throw new Error("Ticket data not found in response");k(D.ticket),P(D.user),j({title:D.ticket.title||"",description:D.ticket.description||"",status:D.ticket.status||"new",priority:D.ticket.priority||"medium"})}catch(s){console.error("Error fetching ticket details:",s),E(s instanceof Error?s.message:"An error occurred")}finally{c(!1)}};r.useEffect(()=>{m&&p&&L()},[m,p]);const Z=s=>{const{name:x,value:T}=s.target;j(D=>({...D,[x]:T}))},J=(s,x)=>{j(T=>({...T,[s]:x}))},je=async()=>{b(!0);try{const s=localStorage.getItem("adminToken");if(!s)throw new Error("Admin authentication required. Please log in again.");const x=await fetch(`/api/admin/tickets/${m}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(l)});if(!x.ok)throw x.status===401?(localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.")):new Error("Failed to update ticket");const T=await x.json();k(T),d(!1)}catch(s){E(s instanceof Error?s.message:"An error occurred while saving")}finally{b(!1)}},pe=()=>{n&&j({title:n.title||"",description:n.description||"",status:n.status||"new",priority:n.priority||"medium"}),d(!1)},fe=async()=>{try{const s=localStorage.getItem("adminToken");if(!s)throw new Error("Admin authentication required. Please log in again.");const x=await fetch(`/api/admin/tickets/${m}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!x.ok)throw x.status===401?(localStorage.removeItem("adminToken"),new Error("Authentication expired. Please log in again.")):new Error("Failed to delete ticket");g("/admin-dashboard/tickets")}catch(s){E(s instanceof Error?s.message:"An error occurred while deleting")}},_=s=>{const x=new Date(s);return x.toLocaleDateString()+" "+x.toLocaleTimeString()},we=s=>{switch(s){case"new":return e.jsx(v,{className:"bg-blue-100 text-blue-800",children:"New"});case"processing":return e.jsx(v,{className:"bg-yellow-100 text-yellow-800",children:"Processing"});case"completed":return e.jsx(v,{className:"bg-green-100 text-green-800",children:"Completed"});case"rejected":return e.jsx(v,{className:"bg-red-100 text-red-800",children:"Rejected"});default:return e.jsx(v,{children:s})}},ve=s=>{switch(s){case"low":return e.jsx(v,{className:"bg-gray-100 text-gray-800",children:"Low"});case"medium":return e.jsx(v,{className:"bg-blue-100 text-blue-800",children:"Medium"});case"high":return e.jsx(v,{className:"bg-orange-100 text-orange-800",children:"High"});case"urgent":return e.jsx(v,{className:"bg-red-100 text-red-800",children:"Urgent"});default:return e.jsx(v,{children:s})}};return S?e.jsx("div",{className:"container mx-auto py-6 text-center",children:"Loading ticket details..."}):A?e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"bg-red-100 text-red-800 p-4 rounded-lg mb-6",children:["Error: ",A]}),e.jsx(N,{onClick:()=>g("/admin-dashboard/tickets"),children:"Back to Tickets"})]}):n?e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx(N,{variant:"outline",onClick:()=>g("/admin-dashboard/tickets"),className:"mb-2",children:"← Back to Tickets"}),e.jsxs("h1",{className:"text-2xl font-bold",children:["Ticket Details ",u&&"(Editing)"]})]}),e.jsx("div",{className:"flex space-x-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx(N,{variant:"outline",onClick:pe,disabled:y,children:"Cancel"}),e.jsx(N,{onClick:je,disabled:y,children:y?"Saving...":"Save Changes"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{variant:"outline",onClick:()=>d(!0),children:"Edit Ticket"}),e.jsxs(ne,{children:[e.jsx(le,{asChild:!0,children:e.jsx(N,{variant:"destructive",children:"Delete Ticket"})}),e.jsxs(oe,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Are you sure?"}),e.jsx(he,{children:"This action cannot be undone. This will permanently delete the ticket and all associated tasks."})]}),e.jsxs(me,{children:[e.jsx(ue,{children:"Cancel"}),e.jsx(xe,{onClick:fe,children:"Delete"})]})]})]})]})})]}),e.jsxs(Ae,{defaultValue:"details",children:[e.jsxs(Ie,{className:"mb-4",children:[e.jsx(W,{value:"details",children:"Ticket Information"}),e.jsx(W,{value:"tasks",children:"Tasks"})]}),e.jsx(Y,{value:"details",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(V,{className:"col-span-2",children:[e.jsxs(K,{children:[e.jsx(G,{children:"Ticket Information"}),e.jsxs(De,{children:["Created: ",_(n.createdAt)," | Last Updated: ",_(n.updatedAt)]})]}),e.jsx(Q,{children:u?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title"}),e.jsx(U,{name:"title",value:l.title,onChange:Z})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx(ee,{name:"description",value:l.description,onChange:Z,rows:5})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs(M,{value:l.status,onValueChange:s=>J("status",s),children:[e.jsx(q,{children:e.jsx(H,{placeholder:"Select status"})}),e.jsx(R,{children:e.jsxs(O,{children:[e.jsx(C,{value:"new",children:"New"}),e.jsx(C,{value:"processing",children:"Processing"}),e.jsx(C,{value:"completed",children:"Completed"}),e.jsx(C,{value:"rejected",children:"Rejected"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Priority"}),e.jsxs(M,{value:l.priority,onValueChange:s=>J("priority",s),children:[e.jsx(q,{children:e.jsx(H,{placeholder:"Select priority"})}),e.jsx(R,{children:e.jsxs(O,{children:[e.jsx(C,{value:"low",children:"Low"}),e.jsx(C,{value:"medium",children:"Medium"}),e.jsx(C,{value:"high",children:"High"}),e.jsx(C,{value:"urgent",children:"Urgent"})]})})]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:we(n.status)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Priority"}),e.jsx("div",{className:"mt-1",children:ve(n.priority)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Service"}),e.jsx("div",{className:"mt-1",children:n.serviceName})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Title"}),e.jsx("div",{className:"mt-1 text-lg font-medium",children:n.title})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("div",{className:"mt-1 whitespace-pre-line",children:n.description})]})]})})]}),e.jsxs(V,{children:[e.jsx(K,{children:e.jsx(G,{children:"User Information"})}),e.jsx(Q,{children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Name"}),e.jsxs("div",{className:"mt-1",children:[h.firstName," ",h.lastName]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Username"}),e.jsx("div",{className:"mt-1",children:h.username})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("div",{className:"mt-1",children:e.jsx("a",{href:`mailto:${h.email}`,className:"text-blue-600 hover:underline",children:h.email})})]}),e.jsx(N,{variant:"outline",className:"w-full",onClick:()=>window.open(`/admin/users/${h.id}`,"_blank"),children:"View User Profile"})]}):e.jsx("div",{className:"text-gray-500",children:"User information not available"})})]})]})}),e.jsx(Y,{value:"tasks",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Tasks"}),e.jsxs(te,{open:f,onOpenChange:w,children:[e.jsx(Pe,{asChild:!0,children:e.jsx(N,{children:"Add New Task"})}),e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Create New Task"}),e.jsx(re,{children:"Add a new task for this ticket."})]}),e.jsx(ge,{ticketId:n.id,onSuccess:()=>{w(!1),o()}})]})]})]}),e.jsx(Re,{ticketId:n.id},I)]})})]})]}):e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx("div",{className:"bg-yellow-100 text-yellow-800 p-4 rounded-lg mb-6",children:"Ticket not found"}),e.jsx(N,{onClick:()=>g("/admin-dashboard/tickets"),children:"Back to Tickets"})]})},Ge=()=>{const i=Se(),a=i==null?void 0:i.id;return Ee.useEffect(()=>(document.title="Ticket Details | Admin",()=>{}),[]),console.log("Ticket ID from URL (admin page):",a),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsx(Oe,{ticketIdProp:a})})};export{Ge as default};
